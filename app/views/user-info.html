<ng:include src="'views/header.html'"></ng:include>

<div class="userInformation well">
  <h4> Enter the target's information:</h4>
  <form>
    <p> First Name:
      <input type="text" id ="firstName" ng-model="user.firstName" required/>
    </p>
    <p> Last Name: 
      <input type="text" id ="lastName" ng-model="user.lastName" required/>
    </p>
    <p> Date of birth:
      <select id="days" class="DoB" ng-model="dayBirth" required></select>
      <select id="months" class="DoB" ng-model="monthBirth" ng-change="resetDay()" required></select>
      <select id="years" class="DoB" ng-model="yearBirth" ng-change="resetDay()" required></select>
    </p>
    <p>
      <input type="button" value="Confirm" class="btns btn-primary" ng-click="setBirthDate()"/>
      <input type="button" value="Reset" class="btns btn-primary" ng-click="resetForm()" />
    </p>

    <table id="userInformationConfirm" ng-show="profileSet" class = "table table-striped table-bordered">
      <thead>
      <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Date of birth</th>
      </tr>
      </thead>
      <tbody>
      <tr>
          <td>{{user.firstName}}</td>
          <td>{{user.lastName}}</td>
          <td>{{user.dateOfBirth}}</td>
       </tr>
      </tbody>
    </table>  
  </form>

</div>

<div>
  <span id="signinButton">
    <span
      class="g-signin"
      data-callback="signinCallback"
      data-clientid="1013860809668-jkso8eqkoik68cu0k7vfkl7gjh3tj47i.apps.googleusercontent.com"
      data-cookiepolicy="single_host_origin"
      data-requestvisibleactions="http://schemas.google.com/AddActivity"
      data-scope="https://www.googleapis.com/auth/plus.login">
    </span>
  </span>
  <gcse:search></gcse:search>
</div>


<div class="footer">
  <p><span class="glyphicon glyphicon-heart"></span> Application based on the basic application from</p>
</div>

<script>

  $(function() {
    for (i = new Date().getFullYear(); i > 1900; i--)
    {
        $('#years').append($('<option />').val(i).html(i));
    }
        
    for (i = 1; i <= 12; i++)
    {
        $('#months').append($('<option />').val(i).html(i));
    }
        
    $('#years, #months').change(function(){
        updateDays(); 
    });

    $('link[rel=stylesheet][href="styles/tables.css"]').remove();
  });


function signinCallback(authResult) {
  console.log(authResult);
  if (authResult['access_token']) {
    // Autorisation réussie
    // Masquer le bouton de connexion maintenant que l'utilisateur est autorisé, par exemple :
    console.log('User connected successfully');
    document.getElementById('signinButton').setAttribute('style', 'display: none');
  } else if (authResult['error']) {
    // Codes d'erreur possibles :
    //   "access_denied" - L'utilisateur a refusé l'accès à votre application
    //   "immediate_failed" - La connexion automatique de l'utilisateur a échoué
    console.log('An error occured while logging in : ' + authResult['error']);
  }
}

  function updateDays(){
    $('#days').html('');
    month = $('#months').val();
    year = $('#years').val();
    days = updateMonth(month, year);

    for(i=1; i < days+1 ; i++)
    {
        $('#days').append($('<option />').val(i).html(i));
    }

  }

  function updateMonth(month, year) {
    return new Date(year, month, 0).getDate();
  }

</script>